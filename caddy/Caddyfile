{
    # For development/testing - use auto_https off to avoid certificate issues on localhost
    auto_https off
}

# Standard HTTP and HTTPS ports
:80 {
    # Redirect HTTP to HTTPS in production
    # redir https://{host}{uri} permanent
    
    # For development, just proxy directly without redirection
    reverse_proxy nextjs:3000
}

:443 {
    # Reverse proxy to Next.js
    reverse_proxy nextjs:3000
    
    # For development, use self-signed certs
    tls internal
    
    # For production with a real domain, uncomment:
    # tls your-email@example.com
    
    # Logging
    log {
        output file /var/log/caddy/access.log
    }
}

# Production configuration (uncomment and replace yourdomain.com when ready):
malmrose.com {
    reverse_proxy nextjs:3000
}