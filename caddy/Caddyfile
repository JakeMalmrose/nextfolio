{
    # Global options
    # Disable automatic HTTPS for IP addresses (needed for IP-based access)
    auto_https off
}

# IP address configuration
174.23.147.40 {
    # Reverse proxy to Next.js
    reverse_proxy nextjs:3000
    
    # Log settings
    log {
        output file /var/log/caddy/access.log
    }
}

# Standard HTTP and HTTPS ports (for when domain isn't specified)
:80 {
    # Reverse proxy directly to Next.js
    reverse_proxy nextjs:3000
}

:443 {
    # Reverse proxy to Next.js
    reverse_proxy nextjs:3000
    
    # For development/testing with IP, use self-signed certs
    tls internal
    
    # Logging
    log {
        output file /var/log/caddy/access.log
    }
}

# Domain configuration (commented out until ready to use)
# malmrose.com {
#     # For production domain, enable automatic HTTPS
#     tls your-email@example.com
#     
#     # Reverse proxy to Next.js
#     reverse_proxy nextjs:3000
#     
#     # Logging
#     log {
#         output file /var/log/caddy/access.log
#     }
# }
